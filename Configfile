DOCKER_EDGE_REGISTRY ?=hyc-cloud-private-edge-docker-local.artifactory.swg-devops.com
DOCKER_SCRATCH_REGISTRY ?=hyc-cloud-private-scratch-docker-local.artifactory.swg-devops.com
DOCKER_INTEGRATION_REGISTRY ?=hyc-cloud-private-integration-docker-local.artifactory.swg-devops.com
DOCKER_REGISTRY ?=$(DOCKER_INTEGRATION_REGISTRY)
DOCKER_SERVER ?=$(DOCKER_INTEGRATION_REGISTRY)
DOCKER_NAMESPACE ?=ibmcom

GIT_REMOTE_URL = $(shell git config --get remote.origin.url)
DOCKER_USERNAME ?= mcmdev@us.ibm.com
DOCKER_USER ?=$(DOCKER_USERNAME)
DOCKER_PASS ?=$(DOCKER_PASSWORD)
IMAGE_VERSION := $(shell git rev-parse --short HEAD)
IMAGE_DESCRIPTION = mcm-configurationpolicy
# image name must be provided for each image
IMAGE_REPO ?=$(DOCKER_INTEGRATION_REGISTRY)/$(DOCKER_NAMESPACE)
IMAGE_NAME ?= mcm-configurationpolicy
RELEASE_TAG ?= latest
RELEASE_TAG_RED_HAT ?= $(RELEASE_TAG)-rhel
SEMVERSION_RED_HAT ?=$(SEMVERSION)-rhel
HOST ?= 127.0.0.1
APP_PORT ?= 8080
CONTAINER_PORT ?= 8080
ARCH = $(shell uname -m)
DOCKER_FLAG =
MAX_IMAGE_SIZE=1000000000
# based on https://github.ibm.com/IBMPrivateCloud/roadmap/issues/12412#issuecomment-7925946 image name should be ibmcom
IMAGE_NAMESPACE = ibmcom 

ifeq ($(ARCH), x86_64)
	IMAGE_NAME_ARCH = $(IMAGE_NAME)-amd64
else
	IMAGE_NAME_ARCH = $(IMAGE_NAME)-$(ARCH)
endif
MANIFEST_VERSION ?= v0.7.0
DEFAULT_S390X_IMAGE ?= ibmcom/pause-s390x:3.0
IMAGE_NAME_S390X ?= ${IMAGE_REPO}/${IMAGE_NAME}-s390x:${RELEASE_TAG}

#new additions for the UBI image
#Variables for redhat required labels
IMAGE_DISPLAY_NAME=MCM ConfigurationPolicy
IMAGE_MAINTAINER=will.kutler@ibm.com
IMAGE_VENDOR=IBM
IMAGE_SUMMARY=$(IMAGE_DESCRIPTION)
IMAGE_OPENSHIFT_TAGS=MCM ConfigurationPolicy

ARCH ?= amd64

DOCKER_GO_BUILD_DIR=/go/src/github.ibm.com/IBMPrivateCloud/$(IMAGE_NAME)/_build

API_TESTFLAGS=-v -race -covermode=atomic -coverprofile=cover.out
GOPACKAGES=$(shell go list ./... | grep -v /vendor/)

GOFILES = $(shell find . -type f -name '*.go' -not -path "./vendor/*")
GOPATH ?= $(shell pwd)
SRC = .

OS ?= $(shell uname -a | cut -d ' ' -f 1 | tr '[:upper:]' '[:lower:]')

DOCKER_BUILD_TAG ?=$(IMAGE_VERSION)
SCRATCH_TAG ?=$(DOCKER_BUILD_TAG)
DOCKER_TAG ?=$(RELEASE_TAG)
DOCKER_IMAGE ?=$(IMAGE_NAME)
DOCKER_IMAGE_ARCH ?=$(IMAGE_NAME_ARCH)
VCS_REF =$(DOCKER_TAG)

DOCKER_BUILD_OPTS=--build-arg "VCS_REF=$(SEMVERSION)" \
	--build-arg "VCS_URL=$(GIT_REMOTE_URL)" \
	--build-arg "IMAGE_NAME=$(IMAGE_NAME)" \
	--build-arg "IMAGE_DESCRIPTION=$(IMAGE_DESCRIPTION)" \
	--build-arg "IMAGE_DISPLAY_NAME=$(IMAGE_DISPLAY_NAME)" \
	--build-arg "IMAGE_NAME_ARCH=$(IMAGE_NAME_ARCH)" \
	--build-arg "IMAGE_MAINTAINER=$(IMAGE_MAINTAINER)" \
	--build-arg "IMAGE_VENDOR=$(IMAGE_VENDOR)" \
	--build-arg "IMAGE_VERSION=$(IMAGE_VERSION)" \
	--build-arg "IMAGE_DESCRIPTION=$(IMAGE_DESCRIPTION)" \
	--build-arg "IMAGE_SUMMARY=$(IMAGE_SUMMARY)" \
	--build-arg "IMAGE_OPENSHIFT_TAGS=$(IMAGE_OPENSHIFT_TAGS)"

DOCKER_RUN_OPTS=-d 
